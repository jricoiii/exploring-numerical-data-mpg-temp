---
title: "E3 - Exploring Numerical Data"
author: "Jose Rico"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_float: yes
    df_print: kable
---

## Goals
This exploration will examine numerical data.  

The goals of this exploration are to explore numerical and graphical summaries for numerical variables

* graphical summaries
  + histograms
  + boxplots
  + dotplots
  + density curves
* numerical summary statistics
  + mean
  + median
  + Q1 and Q3
  + min and max


## Data
We will look at two different data sets;

* `vehicle.csv` containing EPA fuel economy for vehicles from 1984-2020  

* `climate.csv` containing August 2019 daily high and low temperatures for Fremont, Santa Cruz, Sacramento and Santa Barbara

## Packages Needed
* `ggplot2` for graphing
* `dplyr` for data wrangling
* `readr` for reading `csv` files
* `purrr` for quick summaries 
* `kableExtra` for producing better looking tables.
* `plotly` for creating interactive graphics  

Library the needed packages
```{r, message=F}
library(ggplot2)
library(dplyr)
library(readr)
library(purrr)
library(kableExtra)
library(plotly)
```

## Exploring `climate` data

Reading in data with `readr`
```{r}
climate <-read.csv("climate.csv")
```

Glimpse data to asses variable types
```{r}
glimpse(climate)
```

## Visual Exploration

Let's view a variety of visualization of a single numerical variable  

* Fremont's Daily High Temperature for August 2019

### Look at connection between graphs
Closer look at boxplot connection to histogram

#### Classic Dot Plot
```{r, echo=F}
climate %>% 
  filter(City=="Fremont") %>% 
  ggplot(aes(High)) +
  geom_dotplot(binwidth=1,stackratio=1.0, dotsize=1, fill="red")
```

#### Classic Histogram
```{r, echo=F}
p<-climate %>% 
  filter(City=="Fremont") %>% 
  ggplot(aes(x=High)) +
  geom_histogram(binwidth = 1,fill="red",color="white")
ggplotly(p)
```

#### Density Curve
```{r, echo=F}
p<-climate %>% 
  filter(City=="Fremont") %>% 
  ggplot(aes(x=High)) +
  geom_density( fill="red",color="white")
ggplotly(p)
```

##### Boxplot
```{r, echo=F}
p<-climate %>% 
  filter(City=="Fremont") %>% 
  ggplot(aes(y=High, x=City)) +
  geom_boxplot(fill="red")+
  coord_flip()
ggplotly(p)
```

#### Violin Plot
```{r, echo=F}
climate %>% 
  filter(City=="Fremont") %>% 
  ggplot(aes(y=High, x=City)) +
  geom_violin(fill="red",color="white")+
  coord_flip()

```

##### Boxplot with *jittered* data points
```{r, echo=F}
p<-climate %>% 
  filter(City=="Fremont") %>% 
  ggplot(aes(y=High, x=City)) +
  geom_boxplot(fill ="red")+
  geom_jitter(width=0.2, alpha=0.5)+
  coord_flip()
ggplotly(p)
```

#### Dotplot with dots *centered* on axis
```{r, echo=F}
climate %>% 
  filter(City=="Fremont") %>% 
  ggplot(aes(High)) +
  geom_dotplot(binwidth=1,stackratio=1.0, dotsize=1, stackdir="center", fill="red")
```

### Comparing groups with summary visualization
Let's compare the daily high temperatures for four different cities in a **dotplot**

```{r}
ggplot(climate, aes(High, fill=City)) +
  geom_dotplot(binwidth=1,stackratio=1.0, dotsize=1)+
  facet_wrap(~City, nrow=4)
```

View the temperatures for each city in a faceted **histogram**

```{r}
p<-ggplot(climate, aes(High, fill=City)) +
  geom_histogram(binwidth = 2, color="white")+
  facet_wrap(~City, nrow=4)
ggplotly(p)
```

View the temperatures for each city in a faceted **density curve**
```{r}
p<-ggplot(climate, aes(High, color=City)) +
  geom_density()+
  facet_wrap(~City, nrow=4)
ggplotly(p)
```

View the temperatures for each city in single **histogram**
```{r}
p<-ggplot(climate, aes(High, fill=City)) +
  geom_histogram(binwidth = 1, color="white")
ggplotly(p)
```

View the temperatures for each city in a single **density curve**
```{r}
p<-ggplot(climate, aes(High, color=City)) +
  geom_density()
ggplotly(p)
```
View the temperatures for each city in a single **density curve** with shading
```{r}
p<-ggplot(climate, aes(High, color=City, fill=City)) +
  geom_density(alpha=0.25)
ggplotly(p)
```

View the temperatures for each city in a **boxplot**
```{r}
p<-ggplot(climate, aes(x= City, y=High, color=City)) +
  geom_boxplot()+
  coord_flip()
ggplotly(p)
```

View the temperatures for each city in a **violin plot**
```{r}
p<-ggplot(climate, aes(x= City, y=High, fill=City)) +
  geom_violin()+
  coord_flip()
ggplotly(p)
```

Add data points
```{r}
p<-ggplot(climate, aes(x= City, y=High, fill=City)) +
  geom_violin(draw_quantiles = c(0.25, 0.5, 0.75))+
  coord_flip()
p
```

## Classic Numerical Summary Statistics

### Simple one line summary 
Note: Does not break the variable down

```{r}
summary(climate$High)
```
### Using `group_by` and `summarize` functions to obtain a summary statistic (e.g., IQR)
```{r}
climate %>% 
  group_by(City) %>% 
  summarize(High_IQR=IQR(High))
```

### Using same structure you can add summary statistics of interest inside `summarize`
```{r}
high_sum <- climate %>% 
  group_by(City) %>% 
  summarize(High_min=min(High), High_q1=quantile(High, 0.25),  High_median=median(High),  High_q3=quantile(High, 0.75), High_max=max(High), High_mean=mean(High), High_sd=sd(High), High_IQR=IQR(High))
high_sum
```

### Improving table format with `kableExtra` package
```{r}
high_sum %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>% 
  add_header_above(c("Summary of Daily High Temperatures"=9))
```
### Summarize using `purrr` package
```{r}
climate %>%  
  split(.$City) %>% 
  map(summary)
```























